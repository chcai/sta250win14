{
    "contents" : "library('animint')\nlibrary('maps')\n\nload('dat2.rda')\n\n# dat = dat[{dat$Month == 12 & dat$Origin == 'SFO'}, ]\n# dep.dels = \n#   by(dat$DepDelay, list(dat$DayofMonth, dat$Dest), \n#      mean, na.rm = TRUE)\n\ndep.dels = \n  by(dat$DepDelay, list(dat$Origin, dat$UniqueCarrier), \n     mean, na.rm = TRUE)\ndep.dels = matrix(dep.dels, nrow = 30)\n\nbig.airports = sort(big.airports)\ncarriers = sort(as.character(unique(dat$UniqueCarrier)))\ncarriers[8] = 'PA'\n\nmy.colors = matrix(nrow = 30, ncol = 13)\nfor(j in 1:13)\n  for(i in 1:30) \n  {\n    if(is.na(dep.dels[i, j])) \n    {\n      my.colors[i, j] = 'NA'\n    } else \n    {\n      if(dep.dels[i, j] <= 10) my.colors[i, j] = '< 10 mins'\n      if(dep.dels[i, j] > 10 && dep.dels[i, j] <= 20) \n        my.colors[i, j] = '10 - 20 mins'\n      if(dep.dels[i, j] > 20) my.colors[i, j] = '> 20 mins'\n    }\n  }\n\nto.plot = \n  as.data.frame(\n    matrix(\n      c(rep(airports$long, 13), rep(airports$lat, 13)), ncol = 2))\nto.plot = cbind(to.plot, as.vector(my.colors), rep(1:13, each = 30))\nnames(to.plot) = c('long', 'lat', 'colors', 'carrier')\n\nUSpolygons <- map_data(\"state\")\nUSpolygons$state = \n  state.abb[match(USpolygons$region, tolower(state.name))]\n\nmap <- ggplot() + \n  geom_polygon(aes(x = long, y = lat, group = group), \n               data = USpolygons, fill = \"white\", colour = \"grey\") + \n  geom_point(aes(x = long, y = lat, showSelected = carrier, \n                 colour = colors), \n             data = to.plot, size = 4) + \n  scale_color_manual(\n    values = \n      c('NA' = 'grey', '< 10 mins' = 'green', \n        '10 - 20 mins' = 'yellow', '> 20 mins' = 'red'))\n\nall.dels = \n  by(dat$DepDelay, dat$UniqueCarrier, mean, na.rm = TRUE)\nto.plot.ts = \n  as.data.frame(cbind(1:13, all.dels))\nnames(to.plot.ts) = c('carrier', 'delays')\n\nts <- ggplot() + \n  make_tallrect(to.plot.ts, 'carrier') + \n  geom_line(aes(carrier, delays),\n            data = to.plot.ts) + \n  xlab('Carrier') + \n  ylab('Mean Departure Delay') + \n  scale_x_discrete(breaks = 1:13, \n                   labels = carriers)\n\ntime <- list(variable = 'carrier', ms = 5000)\n\nair.anim <- list(map = map, ts = ts, time = time, \n                 width = list(map = 970, ts = 400), \n                 height = list(400))\n\ngg2animint(air.anim, \"tornado-anim\")\n",
    "created" : 1394763487294.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "910733542",
    "id" : "9543D099",
    "lastKnownWriteTime" : 1394838816,
    "path" : "C:/Users/Christine/Google Drive/GitHub/sta250win14/hw4/animint.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}